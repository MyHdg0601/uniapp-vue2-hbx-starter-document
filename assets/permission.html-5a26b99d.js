import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as s,o as r,c as i,a as t,b as n,d as a,e as p}from"./app-1d4ad656.js";const c={},l={class:"hint-container tip"},u=t("p",{class:"hint-container-title"},"提示",-1),h={href:"https://ext.dcloud.net.cn/plugin?id=594",target:"_blank",rel:"noopener noreferrer"},m=t("code",null,"/utils/permission.js",-1),k={id:"ensurepermissionauthorized-scope-config",tabindex:"-1"},_=t("a",{class:"header-anchor",href:"#ensurepermissionauthorized-scope-config","aria-hidden":"true"},"#",-1),b=p(`<p>确保用户已授予对应权限</p><h4 id="参数" tabindex="-1"><a class="header-anchor" href="#参数" aria-hidden="true">#</a> 参数</h4><ul><li><p>scope：<code>EnsurePermissionAuthorizedScope</code> 权限范围</p></li><li><p>config：<code>EnsurePermissionAuthorizedConfig</code> 授权请求配置</p></li></ul><h4 id="类型" tabindex="-1"><a class="header-anchor" href="#类型" aria-hidden="true">#</a> 类型</h4><h5 id="ensurepermissionauthorizedscope" tabindex="-1"><a class="header-anchor" href="#ensurepermissionauthorizedscope" aria-hidden="true">#</a> EnsurePermissionAuthorizedScope</h5><table><thead><tr><th>参数</th><th>说明</th><th>类型</th><th>可选值</th><th>默认值</th></tr></thead><tbody><tr><td>mp</td><td>小程序权限的scope</td><td>string</td><td>参考微信小程序官方文档</td><td>-</td></tr><tr><td>android</td><td>Android权限的permissionId</td><td>string</td><td>参考Android官方文档</td><td>-</td></tr><tr><td>ios</td><td>iOS权限的permissionId</td><td>string</td><td>参考iOS官方文档</td><td>-</td></tr></tbody></table><h5 id="ensurepermissionauthorizedconfig" tabindex="-1"><a class="header-anchor" href="#ensurepermissionauthorizedconfig" aria-hidden="true">#</a> EnsurePermissionAuthorizedConfig</h5><table><thead><tr><th>参数</th><th>说明</th><th>类型</th><th>可选值</th><th>默认值</th></tr></thead><tbody><tr><td>settings</td><td>拒绝授权时是否跳转至设置页</td><td>boolean</td><td>-</td><td><code>true</code></td></tr><tr><td>modalTitle</td><td>申请权限弹窗标题</td><td>string</td><td>-</td><td>权限申请</td></tr><tr><td>modalContent</td><td>申请权限弹窗内容</td><td>string</td><td>-</td><td>-</td></tr></tbody></table><details class="hint-container details"><summary>使用示例（点击展开查看）</summary><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 申请定位权限</span>
<span class="token keyword">await</span> <span class="token function">ensurePermissionAuthorized</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mp</span><span class="token operator">:</span> <span class="token string">&quot;scope.userLocation&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">android</span><span class="token operator">:</span> <span class="token string">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ios</span><span class="token operator">:</span> <span class="token string">&quot;location&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">modalContent</span><span class="token operator">:</span> <span class="token string">&quot;您已拒绝授予定位权限，需要手动开启定位权限，是否立即跳转至设置页面？&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 权限申请成功后，继续执行逻辑</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> longitude<span class="token punctuation">,</span> latitude <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> uni<span class="token punctuation">.</span>pro<span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;gcj02&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isHighAccuracy</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;经纬度&quot;</span><span class="token punctuation">,</span> longitude<span class="token punctuation">,</span> latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h4 id="附录" tabindex="-1"><a class="header-anchor" href="#附录" aria-hidden="true">#</a> 附录</h4><h5 id="ios部分权限清单-详细请查阅ios官方文档" tabindex="-1"><a class="header-anchor" href="#ios部分权限清单-详细请查阅ios官方文档" aria-hidden="true">#</a> iOS部分权限清单（详细请查阅iOS官方文档）</h5><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>location</td><td>位置</td></tr><tr><td>push</td><td>推送</td></tr><tr><td>camera</td><td>摄像头</td></tr><tr><td>photoLibrary</td><td>相册</td></tr><tr><td>record</td><td>麦克风</td></tr><tr><td>contact</td><td>通讯录</td></tr><tr><td>calendar</td><td>日历</td></tr><tr><td>memo</td><td>备忘录</td></tr></tbody></table><h5 id="android部分权限清单-详细请查阅android官方文档" tabindex="-1"><a class="header-anchor" href="#android部分权限清单-详细请查阅android官方文档" aria-hidden="true">#</a> Android部分权限清单（详细请查阅Android官方文档）</h5><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>android.permission.ACCESS_FINE_LOCATION</td><td>位置权限</td></tr><tr><td>android.permission.ACCESS_COARSE_LOCATION</td><td>模糊位置权限</td></tr><tr><td>android.permission.CAMERA</td><td>摄像头权限</td></tr><tr><td>android.permission.READ_EXTERNAL_STORAGE</td><td>外部存储(含相册)读取权限</td></tr><tr><td>android.permission.WRITE_EXTERNAL_STORAGE</td><td>外部存储(含相册)写入权限</td></tr><tr><td>android.permission.RECORD_AUDIO</td><td>麦克风权限</td></tr><tr><td>android.permission.READ_CONTACTS</td><td>通讯录读取权限</td></tr><tr><td>android.permission.WRITE_CONTACTS</td><td>通讯录写入权限</td></tr><tr><td>android.permission.READ_CALENDAR</td><td>日历读取权限</td></tr><tr><td>android.permission.WRITE_CALENDAR</td><td>日历写入权限</td></tr><tr><td>android.permission.READ_SMS</td><td>短信读取权限</td></tr><tr><td>android.permission.SEND_SMS</td><td>短信发送权限</td></tr><tr><td>android.permission.RECEIVE_SMS</td><td>接收新短信权限</td></tr><tr><td>android.permission.READ_PHONE_STATE</td><td>获取手机识别码等信息的权限</td></tr><tr><td>android.permission.CALL_PHONE</td><td>拨打电话权限</td></tr><tr><td>android.permission.READ_CALL_LOG</td><td>获取通话记录权限</td></tr></tbody></table>`,14);function A(v,E){const d=s("ExternalLinkIcon"),e=s("badge");return r(),i("div",null,[t("div",l,[u,t("p",null,[n("项目中基于"),t("a",h,[n("权限插件"),a(d)]),n("二次封装了权限申请方法("),m,n(")，用于确保用户已授予权限后才会继续执行逻辑，并且支持同时申请微信小程序、Android、iOS多端权限（亦可根据需要自行扩展其他端），也兼容了用户拒绝授权的场景")])]),t("h3",k,[_,n(" ensurePermissionAuthorized(scope, config) "),a(e,{text:"async",type:"info"})]),b])}const y=o(c,[["render",A],["__file","permission.html.vue"]]);export{y as default};
